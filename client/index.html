<!doctype html>
<title>Cloud translate socket test</title>

<div>
  <p>Text to Translate:</p>
  <textarea id=textToTranslate></textarea>
</div>

<label for=languageSelector>Select language to translate to:</label>

<select name=language id=languageSelector>
    <option value=en>English</option>
    <option value=fr>French</option>
    <option value=de>German</option>
    <option value=zh-cn>Chinese</option>
</select>

<div>
  <p>Translated Text:</p>
  <textarea id=translatedText></textarea>
</div>

<script>
  const ws = new WebSocket('ws://' + window.location.hostname + ':' +
    (window.location.port || 80) + '/');
  const textToTranslate = document.querySelector('#textToTranslate');
  const translatedText = document.querySelector('#translatedText');
  const languageSelector = document.querySelector('#languageSelector');

  function toServer(e) {
    ws.send(JSON.stringify({
      text: textToTranslate.value,
      target: languageSelector.value
    }));
  }

  function fromServer(e) {
    translatedText.value = e.data;
    console.log(e.data);
  }

  textToTranslate.addEventListener('keyup', toServer);
  languageSelector.addEventListener('change', toServer);
  ws.addEventListener('message', fromServer);
</script>
